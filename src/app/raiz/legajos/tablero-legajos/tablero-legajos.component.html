<div class="mt-3">
    <div class="d-flex justify-content-end">
        <button type="button" class="btn boton-filtros me-3" (click)="openModalChoferes()">
          Legajos visibles
        </button>
        <div class="btn-group ">
            <button type="button" class="btn boton-filtros">
              {{filtrosProveedores ? filtrosProveedores : "Proveedores"}}
            </button>
            <button type="button" class="btn boton dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false">
                <span class="visually-hidden">Toggle Dropdown</span>
            </button>
            <ul class="dropdown-menu">
                @for (p of $proveedores ; track p) {
                  <li class="dropdown-item" (click)="filtrarChoferes(p.idProveedor, p.razonSocial)">{{p.razonSocial}}</li>
                }
                <li class="dropdown-item" (click)="filtrarChoferes(0, '')">Limpiar Filtro</li>
            </ul>
        </div>
    </div>
    <input class="form-control" type="text" [(ngModel)]="searchText" placeholder="Buscar por chofer">
    <table class="table table-striped table-bordered">
        <thead class="sticky-top">
            <tr>
                <th style="width:15%">Chofer</th>
                <th style="width: 8%;">Estado</th>
                <th style="width: 6%;">Dni</th>
                <th style="width: 6.5%;">Ant. Penales</th>
                <th style="width: 6.5%;">Licencia</th>
                <th style="width: 6.5%;">LINTI</th>
                <th style="width: 6.5%;">L. Sanitaria</th>
                <th style="width: 6.5%;">ART/ ACC Personales</th>
                <th style="width: 6.5%;">Cedula</th>
                <th style="width: 6%;">Titulo</th>
                <th style="width: 6.5%;">Seguro</th>
                <th style="width: 6.5%;">VTV/RTO</th>
                <th style="width: 6.5%;">RUTA</th>
                <th style="width: 6.5%;">SENASA</th> 
                <th style="width: 6.5%">Fotos</th>               
            </tr>
        </thead>        
        @if ($legajosFiltrados.length > 0) {
            @for (legajo of $legajosFiltrados | buscarPorChofer: searchText : $choferes; track legajo) {
                @if (legajo.visible) {
                    <tr>
                        <td>{{ getChofer(legajo.idChofer) }}</td>
                        <td
                          [ngClass]="{
                            rojo: legajo.estadoGral.vencido,
                            verde: legajo.estadoGral.enFecha,
                            amarillo: legajo.estadoGral.porVencer,
                            gris: legajo.estadoGral.vacio
                          }"
                        >
                          {{
                            legajo.estadoGral.vencido
                              ? 'Vencido'
                              : legajo.estadoGral.porVencer
                              ? 'Por vencer'
                              : legajo.estadoGral.enFecha
                              ? 'En fecha'
                              : '-'
                          }}
                        </td>

                        @for (titulo of titulos; track titulo) {
                            <td
                              [ngClass]="{
                                celeste: getDocumento(legajo.documentacion, titulo)?.sinVto,
                                verde: getDocumento(legajo.documentacion, titulo)?.estado?.enFecha,
                                amarillo: getDocumento(legajo.documentacion, titulo)?.estado?.porVencer,
                                rojo: getDocumento(legajo.documentacion, titulo)?.estado?.vencido
                              }"
                            >
                              {{
                                getDocumento(legajo.documentacion, titulo)?.sinVto
                                  ? 'Sin Vto'
                                  : getDocumento(legajo.documentacion, titulo)
                                    ? getDocumento(legajo.documentacion, titulo)?.fechaVto
                                    : "-"
                              }}
                            </td>
                        }                        
                    </tr>
                }
            }
        } @else {
            <tbody>
                <tr><td colspan="14">Sin Datos</td></tr>
            </tbody>
        }

    </table>
</div>
@if (isLoading) {
  <app-spinner></app-spinner>
}